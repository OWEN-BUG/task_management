{
  "info": {
    "name": "TaskManager_Full",
    "description": "任务管理系统完整接口集合（含管理员与普通用户）",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:8080", "type": "string" },
    { "key": "token", "value": "", "type": "string" }
  ],
  "item": [
    {
      "name": "User 注册",
      "request": {
        "method": "POST",
        "header": [{ "key": "Content-Type", "value": "application/json" }],
        "body": { "mode": "raw", "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin123\",\n  \"role\": 0\n}" },
        "url": "{{baseUrl}}/api/users/register"
      }
    },
    {
      "name": "User 登录",
      "request": {
        "method": "POST",
        "header": [{ "key": "Content-Type", "value": "application/json" }],
        "body": { "mode": "raw", "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin123\"\n}" },
        "url": "{{baseUrl}}/api/users/login",
        "event": [
          {
            "listen": "test",
            "script": {
              "exec": ["pm.environment.set('token', pm.response.text());"]
            }
          }
        ]
      }
    },
    {
      "name": "获取当前登录用户信息",
      "request": {
        "method": "GET",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/users/me"
      }
    },
    {
      "name": "获取所有用户（管理员）",
      "request": {
        "method": "GET",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/users"
      }
    },
    {
      "name": "获取普通用户列表（管理员）",
      "request": {
        "method": "GET",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/users/normal"
      }
    },
    {
      "name": "更新用户角色（管理员）",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"role\": 9\n}" },
        "url": "{{baseUrl}}/api/users/2/role"
      }
    },
    {
      "name": "删除用户",
      "request": {
        "method": "DELETE",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/users/3"
      }
    },
    {
      "name": "更新当前用户密码",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"password\": \"newpass123\"\n}" },
        "url": "{{baseUrl}}/api/users/me"
      }
    },
    {
      "name": "创建任务（管理员）",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"title\": \"项目文档\",\n  \"description\": \"撰写并整理项目文档\",\n  \"dueDate\": \"2025-08-10T12:00:00.000Z\",\n  \"priority\": 1\n}" },
        "url": "{{baseUrl}}/api/tasks"
      }
    },
    {
      "name": "获取用户任务列表（分页+筛选）",
      "request": {
        "method": "GET",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks?page=1&size=10&status=PENDING&keyword=文档"
      }
    },
    {
      "name": "分配任务给用户（管理员）",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"userId\": 2\n}" },
        "url": "{{baseUrl}}/api/tasks/1/assign"
      }
    },
    {
      "name": "更新任务评分（管理员）",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"score\": 95.5\n}" },
        "url": "{{baseUrl}}/api/tasks/user-tasks/1/score"
      }
    },
    {
      "name": "更新用户任务状态",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"status\": \"DONE\"\n}" },
        "url": "{{baseUrl}}/api/tasks/user-tasks/1/status"
      }
    },
    {
      "name": "删除用户任务",
      "request": {
        "method": "DELETE",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks/user-tasks/1"
      }
    },
    {
      "name": "获取月度评分统计（管理员）",
      "request": {
        "method": "GET",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks/stats/monthly-scores?year=2025&month=8"
      }
    },
    {
      "name": "添加任务评论",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"content\": \"任务已完成，请查收！\"\n}" },
        "url": "{{baseUrl}}/api/tasks/1/comments"
      }
    },
    {
      "name": "获取任务评论列表",
      "request": {
        "method": "GET",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks/1/comments"
      }
    },
    {
      "name": "添加子任务",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"title\": \"撰写设计文档\",\n  \"status\": \"PENDING\"\n}" },
        "url": "{{baseUrl}}/api/tasks/1/subtasks"
      }
    },
    {
      "name": "获取任务子任务列表",
      "request": {
        "method": "GET",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks/1/subtasks"
      }
    },
    {
      "name": "更新子任务",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": { "mode": "raw", "raw": "{\n  \"title\": \"更新设计文档\",\n  \"status\": \"IN_PROGRESS\"\n}" },
        "url": "{{baseUrl}}/api/tasks/subtasks/1"
      }
    },
    {
      "name": "删除子任务",
      "request": {
        "method": "DELETE",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks/subtasks/1"
      }
    },
    {
      "name": "获取未读通知",
      "request": {
        "method": "GET",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks/notifications/unread"
      }
    },
    {
      "name": "标记通知为已读",
      "request": {
        "method": "PUT",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks/notifications/1/read"
      }
    },
    {
      "name": "删除整个任务（管理员）",
      "request": {
        "method": "DELETE",
        "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
        "url": "{{baseUrl}}/api/tasks/1"
      }
    }
  ]
}
